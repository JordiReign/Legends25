<script>
  const sheetID = '1NVIxXEAfhMwqZtGXTCHXc_vy49zT5Nv888BZB_eOZh4';
  const sheetName = 'CLASIFICACIÃ“N';
  const url = `https://docs.google.com/spreadsheets/d/${sheetID}/gviz/tq?sheet=${sheetName}`;

  fetch(url)
    .then(res => res.text())
    .then(data => {
      const json = JSON.parse(data.substr(47).slice(0, -2));
      const rows = json.table.rows;

      let contenedor = document.getElementById('contenedor');
      let currentGroup = '';
      let table = null;

      rows.forEach(row => {
        const values = row.c.map(cell => cell ? cell.v : '');

        if (values[0] !== currentGroup) {
          currentGroup = values[0];
          table = document.createElement('table');
          table.innerHTML = `
            <caption><strong>Grup ${currentGroup}</strong></caption>
            <thead>
              <tr>
                <th>Equip</th>
                <th>Punts</th>
                <th>PJ</th>
                <th>PG</th>
                <th>PE</th>
                <th>PP</th>
                <th>GF</th>
                <th>GC</th>
                <th>DIF</th>
              </tr>
            </thead>
            <tbody></tbody>
          `;
          contenedor.appendChild(table);
        }

        let tr = document.createElement('tr');
        for (let i = 1; i < values.length; i++) {
          let td = document.createElement('td');
          td.textContent = values[i];
          tr.appendChild(td);
        }
        table.querySelector('tbody').appendChild(tr);
      });
    })
    .catch(err => {
      document.getElementById('contenedor').innerHTML = '<p>Error en carregar les dades.</p>';
      console.error(err);
    });
</script>
